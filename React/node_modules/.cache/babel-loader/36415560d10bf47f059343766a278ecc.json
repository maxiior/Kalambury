{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Maksim\\\\Desktop\\\\KalamburREST\\\\Frontend\\\\kalambury\\\\src\\\\components\\\\Board.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useEffect, useState } from 'react';\nimport './styles/board.css';\nimport TextInput from './TextInput';\nimport PlayersList from './PlayersList';\nimport Header from './Header';\nimport MessagesList from './MessagesList';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Board = () => {\n  _s();\n\n  const canvasRef = useRef(null);\n  const colorsRef = useRef(null);\n  const socketRef = useRef();\n  const [players, setPlayer] = useState([{\n    id: 1,\n    nick: 'maxiior',\n    points: 250\n  }, {\n    id: 2,\n    nick: 'maki',\n    points: 120\n  }, {\n    id: 3,\n    nick: 'misior',\n    points: 220\n  }, {\n    id: 4,\n    nick: 'tadeo',\n    points: 190\n  }]);\n  const [messages, setMessage] = useState([]);\n\n  const addMessage = message => {\n    const id = Math.floor(Math.random() * 10000) + 1;\n    const newMessage = {\n      id,\n      ...message\n    };\n    setMessage([...messages, newMessage]);\n\n    if (messages.length > 5) {\n      messages.pop();\n    }\n  };\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const test = colorsRef.current;\n    const context = canvas.getContext('2d');\n    let dataURL = '';\n    const colors = document.getElementsByClassName('color');\n    const current = {\n      color: 'black'\n    };\n\n    const onColorUpdate = e => {\n      current.color = e.target.className.split(' ')[1];\n    };\n\n    for (let i = 0; i < colors.length; i++) {\n      colors[i].addEventListener('click', onColorUpdate, false);\n    }\n\n    let drawing = false;\n\n    const drawLine = (x0, y0, x1, y1, color, send) => {\n      context.beginPath();\n      context.moveTo(x0, y0);\n      context.lineTo(x1, y1);\n      context.strokeStyle = color;\n      context.lineWidth = 2;\n      context.stroke();\n      context.closePath();\n      context.save();\n      dataURL = canvasRef.current.toDataURL('image/png');\n\n      if (!send) {\n        return;\n      }\n\n      const w = canvas.width;\n      const h = canvas.height;\n      socketRef.current.send(JSON.stringify({\n        x0: x0 / w,\n        y0: y0 / h,\n        x1: x1 / w,\n        y1: y1 / h,\n        color\n      }));\n    };\n\n    const onMouseDown = e => {\n      drawing = true;\n      current.x = e.clientX || e.touches[0].clientX;\n      current.y = e.clientY || e.touches[0].clientY;\n    };\n\n    const onMouseMove = e => {\n      if (!drawing) {\n        return;\n      }\n\n      drawLine(current.x, current.y, e.clientX || e.touches[0].clientX, e.clientY || e.touches[0].clientY, current.color, true);\n      current.x = e.clientX || e.touches[0].clientX;\n      current.y = e.clientY || e.touches[0].clientY;\n    };\n\n    const onMouseUp = e => {\n      if (!drawing) {\n        return;\n      }\n\n      drawing = false;\n      drawLine(current.x, current.y, e.clientX || e.touches[0].clientX, e.clientY || e.touches[0].clientY, current.color, true);\n    };\n\n    const throttle = (callback, delay) => {\n      let previousCall = new Date().getTime();\n      return function () {\n        const time = new Date().getTime();\n\n        if (time - previousCall >= delay) {\n          previousCall = time;\n          callback.apply(null, arguments);\n        }\n      };\n    };\n\n    canvas.addEventListener('mousedown', onMouseDown, false);\n    canvas.addEventListener('mouseup', onMouseUp, false);\n    canvas.addEventListener('mouseout', onMouseUp, false);\n    canvas.addEventListener('mousemove', throttle(onMouseMove, 10), false);\n    canvas.addEventListener('touchstart', onMouseDown, false);\n    canvas.addEventListener('touchend', onMouseUp, false);\n    canvas.addEventListener('touchcancel', onMouseUp, false);\n    canvas.addEventListener('touchmove', throttle(onMouseMove, 10), false);\n\n    const onResize = () => {\n      canvas.width = window.innerWidth;\n      canvas.height = window.innerHeight;\n      let img = document.createElement('img');\n      img.src = dataURL;\n      context.drawImage(img, 0, 0);\n      context.restore();\n    };\n\n    window.addEventListener('resize', onResize, false);\n    onResize();\n\n    const onDrawingEvent = data => {\n      const w = canvas.width;\n      const h = canvas.height;\n      drawLine(data.x0 * w, data.y0 * h, data.x1 * w, data.y1 * h, data.color);\n    };\n\n    socketRef.current = new WebSocket('ws://' + window.location.host);\n\n    socketRef.current.onopen = e => {\n      console.log('open', e);\n    };\n\n    socketRef.current.onmessage = e => {\n      onDrawingEvent(JSON.parse(e.data));\n    };\n\n    socketRef.current.onerror = e => {\n      console.log('error', e);\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"inline\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          ref: colorsRef,\n          className: \"colors\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"color red\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"color green\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"color blue\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"color yellow\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"color orange\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"color pink\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"color purple\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"color gray\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"color black\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"inline\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n                ref: canvasRef,\n                className: \"whiteboard\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(PlayersList, {\n              players: players\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextInput, {\n            onAdd: addMessage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(MessagesList, {\n            messages: messages\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 161,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Board, \"krMBMznQI2Iw51v8IE5Aqd/qYRk=\");\n\n_c = Board;\nexport default Board;\n\nvar _c;\n\n$RefreshReg$(_c, \"Board\");","map":{"version":3,"sources":["C:/Users/Maksim/Desktop/KalamburREST/Frontend/kalambury/src/components/Board.js"],"names":["React","useRef","useEffect","useState","TextInput","PlayersList","Header","MessagesList","Board","canvasRef","colorsRef","socketRef","players","setPlayer","id","nick","points","messages","setMessage","addMessage","message","Math","floor","random","newMessage","length","pop","canvas","current","test","context","getContext","dataURL","colors","document","getElementsByClassName","color","onColorUpdate","e","target","className","split","i","addEventListener","drawing","drawLine","x0","y0","x1","y1","send","beginPath","moveTo","lineTo","strokeStyle","lineWidth","stroke","closePath","save","toDataURL","w","width","h","height","JSON","stringify","onMouseDown","x","clientX","touches","y","clientY","onMouseMove","onMouseUp","throttle","callback","delay","previousCall","Date","getTime","time","apply","arguments","onResize","window","innerWidth","innerHeight","img","createElement","src","drawImage","restore","onDrawingEvent","data","WebSocket","location","host","onopen","console","log","onmessage","parse","onerror"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\r\nimport './styles/board.css';\r\nimport TextInput from './TextInput';\r\nimport PlayersList from './PlayersList';\r\nimport Header from './Header';\r\nimport MessagesList from './MessagesList';\r\n\r\nconst Board = () => {\r\n  const canvasRef = useRef(null);\r\n  const colorsRef = useRef(null);\r\n  const socketRef = useRef();\r\n\r\n  const [players, setPlayer] = useState([\r\n    {\r\n      id: 1,\r\n      nick: 'maxiior',\r\n      points: 250\r\n    },\r\n    {\r\n      id: 2,\r\n      nick: 'maki',\r\n      points: 120\r\n    },\r\n    {\r\n      id: 3,\r\n      nick: 'misior',\r\n      points: 220\r\n    },\r\n    {\r\n      id: 4,\r\n      nick: 'tadeo',\r\n      points: 190\r\n    },\r\n  ])\r\n\r\n  const [messages, setMessage] = useState([])\r\n\r\n  const addMessage = (message) => {\r\n    const id = Math.floor(Math.random() * 10000) + 1\r\n    const newMessage = { id, ...message }\r\n    setMessage([...messages, newMessage])\r\n\r\n    if(messages.length>5)\r\n    {\r\n      messages.pop()\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    const test = colorsRef.current;\r\n    const context = canvas.getContext('2d');\r\n    let dataURL = '';\r\n    const colors = document.getElementsByClassName('color');\r\n    const current = {\r\n      color: 'black',\r\n    };\r\n    const onColorUpdate = (e) => {\r\n      current.color = e.target.className.split(' ')[1];\r\n    };\r\n    for (let i = 0; i < colors.length; i++) {\r\n      colors[i].addEventListener('click', onColorUpdate, false);\r\n    }\r\n    \r\n    let drawing = false;\r\n    const drawLine = (x0, y0, x1, y1, color, send) => {\r\n      context.beginPath();\r\n      context.moveTo(x0, y0);\r\n      context.lineTo(x1, y1);\r\n      context.strokeStyle = color;\r\n      context.lineWidth = 2;\r\n      context.stroke();\r\n      context.closePath();\r\n      context.save();\r\n      dataURL = canvasRef.current.toDataURL('image/png');\r\n      if (!send) { return; }\r\n      const w = canvas.width;\r\n      const h = canvas.height;\r\n      socketRef.current.send(JSON.stringify({\r\n        x0: x0 / w,\r\n        y0: y0 / h,\r\n        x1: x1 / w,\r\n        y1: y1 / h,\r\n        color,\r\n      }));\r\n    };\r\n\r\n    const onMouseDown = (e) => {\r\n      drawing = true;\r\n      current.x = e.clientX || e.touches[0].clientX;\r\n      current.y = e.clientY || e.touches[0].clientY;\r\n    };\r\n    \r\n    const onMouseMove = (e) => {\r\n      if (!drawing) { return; }\r\n      drawLine(current.x, current.y, e.clientX ||\r\n      e.touches[0].clientX, e.clientY || e.touches[0].clientY, current.color, true);\r\n      current.x = e.clientX || e.touches[0].clientX;\r\n      current.y = e.clientY || e.touches[0].clientY;\r\n    };\r\n    \r\n    const onMouseUp = (e) => {\r\n      if (!drawing) { return; }\r\n      drawing = false;\r\n      drawLine(current.x, current.y, e.clientX || e.touches[0].clientX, e.clientY || e.touches[0].clientY, current.color, true);\r\n    };\r\n\r\n    const throttle = (callback, delay) => {\r\n      let previousCall = new Date().getTime();\r\n      return function() {\r\n        const time = new Date().getTime();\r\n        if ((time - previousCall) >= delay) {\r\n          previousCall = time;\r\n          callback.apply(null, arguments);\r\n        }\r\n      };\r\n    };\r\n\r\n    canvas.addEventListener('mousedown', onMouseDown, false);\r\n    canvas.addEventListener('mouseup', onMouseUp, false);\r\n    canvas.addEventListener('mouseout', onMouseUp, false);\r\n    canvas.addEventListener('mousemove', throttle(onMouseMove, 10), false);\r\n    canvas.addEventListener('touchstart', onMouseDown, false);\r\n    canvas.addEventListener('touchend', onMouseUp, false);\r\n    canvas.addEventListener('touchcancel', onMouseUp, false);\r\n    canvas.addEventListener('touchmove', throttle(onMouseMove, 10), false);\r\n\r\n    const onResize = () => {\r\n      canvas.width = window.innerWidth;\r\n      canvas.height = window.innerHeight;\r\n      let img = document.createElement('img');\r\n      img.src = dataURL;\r\n      context.drawImage(img, 0,0);\r\n      context.restore();\r\n    };\r\n\r\n    window.addEventListener('resize', onResize, false);\r\n    onResize();\r\n\r\n    const onDrawingEvent = (data) => {\r\n      const w = canvas.width;\r\n      const h = canvas.height;\r\n      drawLine(data.x0 * w, data.y0 * h, data.x1 * w, data.y1 * h, data.color);\r\n    }\r\n\r\n    socketRef.current = new WebSocket('ws://'+ window.location.host)\r\n    socketRef.current.onopen = e => {\r\n      console.log('open', e)\r\n    }\r\n\r\n    socketRef.current.onmessage = e => {\r\n      onDrawingEvent(JSON.parse(e.data))\r\n    }\r\n\r\n    socketRef.current.onerror = e => {\r\n      console.log('error', e)\r\n    }\r\n    \r\n  }, []);\r\n  return (\r\n    <div className=\"main\">\r\n      <div>\r\n        <Header />\r\n        <div className=\"inline\">\r\n          <div ref={colorsRef} className=\"colors\">\r\n            <div className=\"color red\" />\r\n            <div className=\"color green\" />\r\n            <div className=\"color blue\" />\r\n            <div className=\"color yellow\" />\r\n            <div className=\"color orange\" />\r\n            <div className=\"color pink\" />\r\n            <div className=\"color purple\" />\r\n            <div className=\"color gray\" />\r\n            <div className=\"color black\" />\r\n          </div>\r\n          <div>\r\n            <div className=\"inline\">\r\n              <div>\r\n                <canvas ref={canvasRef} className=\"whiteboard\" />\r\n              </div>\r\n              <PlayersList players={players}/>\r\n            </div>\r\n            <TextInput onAdd={addMessage}/>\r\n            <MessagesList messages={messages}/>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default Board;"]},"metadata":{},"sourceType":"module"}